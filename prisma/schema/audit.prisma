model AuditLog {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  userId     String?  @db.ObjectId
  action     String
  resource   String
  resourceId String?
  oldValue   Json?
  newValue   Json?
  ipAddress    String?
  userAgent    String?
  hash         String?  // SHA-256 of this entry's content
  previousHash String?  // SHA-256 of the immediately preceding entry (chain)
  createdAt    DateTime @default(now())

  user User? @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([resource, resourceId])
  @@map("audit_logs")
}
