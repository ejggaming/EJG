enum WalletStatus {
  ACTIVE
  FROZEN
  CLOSED
}

enum TransactionType {
  DEPOSIT
  WITHDRAWAL
  JUETENG_BET
  JUETENG_PAYOUT
  COMMISSION_PAYOUT
  ADJUSTMENT
}

enum TransactionStatus {
  PENDING
  COMPLETED
  FAILED
  REVERSED
}

model Wallet {
  id        String       @id @default(auto()) @map("_id") @db.ObjectId
  userId    String       @unique @db.ObjectId
  balance   Float        @default(0)
  bonus     Float        @default(0)
  currency  String       @default("PHP")
  status    WalletStatus @default(ACTIVE)
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  user         User          @relation(fields: [userId], references: [id])
  transactions Transaction[]

  @@map("wallets")
}

model Transaction {
  id            String            @id @default(auto()) @map("_id") @db.ObjectId
  userId        String            @db.ObjectId
  walletId      String            @db.ObjectId
  type          TransactionType
  amount        Float
  balanceBefore Float
  balanceAfter  Float
  currency      String            @default("PHP")
  status        TransactionStatus @default(PENDING)
  reference     String            @unique
  description   String?
  metadata      Json?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt

  user   User   @relation(fields: [userId], references: [id])
  wallet Wallet @relation(fields: [walletId], references: [id])

  @@index([userId])
  @@index([walletId])
  @@map("transactions")
}
